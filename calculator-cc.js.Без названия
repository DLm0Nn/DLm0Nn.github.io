/*
   Wheelpro spoke length calculator

   Version: public-1

*/
function d(a,b,c){const f=a.h[b].style;c?(e.get(b).style[f]=a.h[b].show,a.h[b].C=!0):(e.get(b).style[f]=a.h[b].s,a.h[b].C=!1)}function aa(a){let b;for(b in a.g)a.g[b].value="failSafe"}
class ba{constructor(){let a,b;this.j=new Map;this.g={pcdL:{i:"a",numeric:!0,l:0,D:!0,name:"Hub diameter - left",title:"Hub diameter"},pcdR:{i:"b",numeric:!0,l:0,D:!0,name:"Hub diameter - right",title:"x"},flangeL:{i:"c",numeric:!0,l:0,name:"Flange offset - left",title:"Flange offset"},flangeR:{i:"d",numeric:!0,l:0,name:"Flange offset - right",title:"x"},holeDia:{i:"f",numeric:!0,l:2,name:"Spoke hole diameter",title:"Spoke hole diameter"},spOffsetL:{i:"h",numeric:!0,l:2,name:"Straight pull spoke offset - left",
title:"Spoke offset"},spOffsetR:{i:"i",numeric:!0,l:2,name:"Straight pull spoke offset - right",title:"x"},pairValue:{i:"pv",numeric:!1,l:1,D:!0,name:"Pair value",title:"Paired hole dimension"},pairLacing:{i:"pl",numeric:!0,l:1,D:!0,name:"Pair lacing",title:"Paired hole lacing option"},eccOffset:{i:"eo",numeric:!0,l:2,D:!0,name:"Eccentric offset",title:"Eccentric offset"},erd:{i:"j",numeric:!0,l:0,D:!0,name:"Rim erd",title:"Rim erd"},asym:{i:"k",numeric:!0,l:1,name:"Rim Asym",title:"Rim asym"},rimHoleWidth:{i:"l",
numeric:!0,l:1,name:"Rim spoke hole width",title:"Width between holes"},g3width:{i:"g3",numeric:!0,l:0,name:"G3 Rim dimension",title:"G3 Rim dimension"},frameOffset:{i:"m",numeric:!0,l:1,v:[],name:"Frame offset",title:"Frame offset"},spokes:{i:"n",numeric:!0,l:0,D:!0,v:["free"],name:"Spokes",title:"Spokes"},tripletSpokes:{i:"p",numeric:!0,l:0,D:!0,v:[],name:"Triplet spokes",title:"Spokes"},lacingOption:{i:"q",numeric:!0,l:0,D:!0,v:[],name:"Triplet lacing option",title:"Lacing option"},crossL:{i:"s",
numeric:!0,l:2,D:!0,v:["free"],name:"Cross - left",title:"Cross"},crossR:{i:"t",numeric:!0,l:2,D:!0,v:["free"],name:"Cross - right",title:"x"},spokeDiaL:{i:"u",numeric:!0,l:0,v:["free"],name:"Spoke diameter - left",title:"Spoke diameter"},spokeDiaR:{i:"R",numeric:!0,l:0,v:["free"],name:"Spoke diameter - right",title:"x"},wheelType:{i:"o",numeric:!0,v:[],name:"Wheel type",U:!0,H:ca},fr:{i:"g",numeric:!0,v:[],name:"Front or Rear",U:!0,H:da},hubName:{i:"e",numeric:!1,name:"Hub name",U:!0,H:ea},rimName:{i:"r",
numeric:!1,name:"Rim name",U:!0,H:ea}};this.h={data_spoke_hole_dia:{style:"display",show:"table-row-group",s:"none",C:!1},data_hub_sp:{style:"display",show:"table-row-group",s:"none",C:!1},data_paired_hub:{style:"display",show:"table-row-group",s:"none",C:!1},data_standard_lacing:{style:"display",show:"table-row-group",s:"none",C:!1},data_triplet_spokes:{style:"display",show:"table-row-group",s:"none",C:!1},data_triplet_lacing:{style:"display",show:"table-row-group",s:"none",C:!1},data_g3_width:{style:"display",
show:"table-row-group",s:"none",C:!1},data_eccentric_offset:{style:"display",show:"table-row-group",s:"none",C:!1}};for(a in this.g)if(this.j.has(this.g[a].i)?console.log(`RM error : duplicate short name ${this.g[a].i} used in data.list`):this.j.set(this.g[a].i,a),this.g[a].H?e.get(a).addEventListener("input",this.g[a].H):e.get(a).addEventListener("input",fa),this.g[a].v)for(b of e.get(a).options)"-"!=b.value&&this.g[a].v.push(b.value)}display(a,b,c){let f;for(f in this.h)a.includes(f)?d(this,f,!0):
d(this,f,!1);c?e.get("togglePair").style.visibility="visible":e.get("togglePair").style.visibility="hidden";b?e.get("frameOffsetWrap").style.display="none":e.get("frameOffsetWrap").style.display="table";aa(this)}get(a){return this.g.hasOwnProperty(a)?this.g[a]:!1}value(a){let b;a in this.g?(b=this.g[a].value,"failSafe"==b&&(h.error("Function data.value("+a+") internal value set to failSafe."),b=999)):(h.error("Function data.value("+a+"). Parameter "+a+" not found in data.list."),b=999);return b}}
function ha(a=!1){var b=new URLSearchParams;if(n(r,"svgShow"))for([,c]of Object.entries(r.g))c.status&&b.append(c.F,"1");var c=[...u.Y,"wheelType","fr","hubName","rimName"];for(g of c)if(!u.u||"frameOffset"!=g){c=b;var f=c.append;var k=g;var l=v;l.g.hasOwnProperty(k)?k=l.g[k].i:(h.error(`Function data.shortName(). Parameter ${k} not found in data.list.`),k=void 0);f.call(c,k,e.get(g).value.trim())}b=b.toString();var g=location;ia=g.origin;return a?`<a href="${g.origin}${g.pathname}?${b}">${g.hostname}</a>`:
`${g.origin}${g.pathname}?${b}`}class ja{constructor(){this.h=0;this.g=new Map}get j(){return this.h}includes(a){return this.g.has(a)?!0:!1}}function ka(a,b,c){let f,k;"input"==b?(a.g[c].O=e.get(c).value,f=a.g[c].S,k=a.g[c].M):(a.g[c].M=e.get(c).value,f=a.g[c].N,k=a.g[c].O);e.get(a.g[c].L).innerHTML=f;e.set(c);e.get(c).addEventListener("input",fa);e.get(c).value=k;a.g[c].G=b}
class la{constructor(){let a,b;this.B="Select list";this.j="User input";this.g={spokes:{L:"spokesContainer",N:"",O:"",S:'<input id="spokes" value="" placeholder="">',M:"",G:"select"},crossL:{L:"crossLeftContainer",N:"",O:"",S:'<input id="crossL" value="" placeholder="">',M:"",G:"select"},crossR:{L:"crossRightContainer",N:"",O:"",S:'<input id="crossR" value="" placeholder="">',M:"",G:"select"},spokeDiaL:{L:"spokeDiaLeftContainer",N:"",O:"",S:'<input id="spokeDiaL" value="" placeholder="">',M:"",G:"select"},
spokeDiaR:{L:"spokeDiaRightContainer",N:"",O:"",S:'<input id="spokeDiaR" value="" placeholder="">',M:"",G:"select"}};this.h={spokesToggle:"spokes",crossLeftToggle:"crossL",crossRightToggle:"crossR",spokeDiaLeftToggle:"spokeDiaL",spokeDiaRightToggle:"spokeDiaR"};for(a in this.g)this.g[a].N=e.get(this.g[a].L).innerHTML;for(b in this.h)e.get(b).addEventListener("click",c=>{c=c.target.id;let f,k,l,g=this.h[c];"select"==this.G(g)?(f="input",k=this.j,l="inputLink"):(f="select",k=this.B,l="selectLink");
ka(this,f,g);e.get(c).innerHTML=k;e.get(c).className=l;w.set("dataChanged",!0);w.set("reDraw",!0)})}G(a){return this.g[a].G}}
function ma(a){w.status("calcDone")?w.status("dataChanged")?na("Save your calculation"):(window.scrollTo(0,0),a?(x.close(),e.get("menu1").style.display="none",e.get("menu2").style.display="none",e.get("saveMenu").style.display="block",e.get("leftWrap").style.display="none",e.get("saveDataInfoWrap").style.display="block",a=oa(),y("wheelComponentsSave",`<h1>${a.o} - ${a.m}</h1><h2>${a.type} : ${a.ca} spokes</h2><h2>${a.X}</h2>`),e.get("calculationWrap").className="displaySave",A("hide")):(e.get("menu1").style.display=
"block",e.get("menu2").style.display="block",e.get("saveMenu").style.display="none",e.get("leftWrap").style.display="block",e.get("saveDataInfoWrap").style.display="none",e.get("calculationWrap").className="displayNormal",A("restore"))):(x.close(),y("generalInfo","<h1>Save your calculation</h1><p>You need to calculate a spoke table first.</p>"),x.show("generalInfo"))}
function oa(){var a=pa(e.get("hubName").value).trim();var b=pa(e.get("rimName").value).trim();var c=v.value("crossL");var f=v.value("crossR");a||="HubName";b||="RimName";c=0==c?"Radial":c+" cross";f=0==f?"Radial":f+" cross";c=c==f?c:c+" - "+f;f=u.u?"Front ":"Rear ";if(u.V){var k=D(v.value("tripletSpokes"));k=`${k.left}:${k.right}`}else k=v.value("spokes");return{o:a,m:b,ca:k,X:c,type:f}}
class qa{constructor(){let a;this.h=!1;this.g={showFieldSettings:{info:"fieldSettings",H:ra,ea:"settingsActive"},showWheelType:{info:"infoWheelType"},showAbout:{info:"infoAbout"},showHelp:{info:"infoHelp"},showWheelData:{info:"infoWheelData"},showHubDia:{info:"infoHubDia"},showFlangeOffset:{info:"infoFlangeOffset"},showSpokeHoleDia:{info:"infoSpokeHoleDia"},showSpokeOffset:{info:"infoSpokeOffset"},showPair:{info:"infoPair"},showErd:{info:"infoErd"},showAsym:{info:"infoAsym"},showWidthHoles:{info:"infoWidthHoles"},
showFrameOffset:{info:"infoFrameOffset"},showSpokes:{info:"infoSpokes"},showCross:{info:"infoCross"},showSpokeDia:{info:"infoSpokeDia"},spokeLengths:{info:"infoSpokeLengths"},spokeClearance:{info:"infoSpokeClearance"},spokeAngle:{info:"infoSpokeAngle"},spokeTension:{info:"infoSpokeTension"},showLeft:{info:"infoLeftRight"},showRight:{info:"infoLeftRight"},showSvgHelp:{info:"infoSvgHelp"},showTripletSpokes:{info:"infoTripletSpokes"},showLaceOption:{info:"infoLaceOption"},showG3width:{info:"infoG3width"},
showEccentric:{info:"infoEccentric"},showCalcLog:{info:"infoCalcLog"},printPage:{info:"infoPrint",H:sa},generalInfo:{info:"generalInfo",W:!0},internalSettings:{info:"internalSettings",W:!0}};for(a in this.g)this.g[a].W||(this.g[a].H?e.get(a).addEventListener("click",this.g[a].H):e.get(a).addEventListener("click",ta),e.get(a).className="showLink");e.get("infoHeader").addEventListener("click",()=>{this.close()})}show(a,b=!1){window.scrollTo(0,0);this.h==a?this.close():(this.close(),e.get("infoHeader").style.display=
"block",e.get(this.g[a].info).style.display="block",void 0===this.g[a].W&&("activeStyle"in this.g[a]?e.get(a).className=this.g[a].ea:e.get(a).className="showLinkActive"),b&&(e.get(this.g[a].info).className=b),this.h=a)}close(){h.g();this.h&&(e.get("infoHeader").style.display="none",e.get(this.g[this.h].info).style.display="none",void 0===this.g[this.h].W&&(e.get(this.h).className="showLink"));this.h=!1}}
function ra(){var a=ua;let b,c,f;for(b in a.h)"select"==a.G(a.h[b])?(c=a.B,f="selectLink"):(c=a.j,f="inputLink"),e.get(b).innerHTML=c,e.get(b).className=f;x.show("showFieldSettings")}function ta(a){a=a.target.id;"showCalcLog"==a&&w.status("dataChanged")?na("Calculation log"):x.show(a)}function va(a){e.get("messageFixedContent").innerHTML=a;e.get("messageFixedWrap").style.display="block"}
class wa{show(a){x.close();e.get("messageText").innerHTML=a;e.get("message").style.display="block";window.scrollTo(0,0)}h(){e.get("messageFixedWrap").style.display="none"}error(a){va("<h1>Program error</h1><p>"+a+"</p><p>This is not your fault.</p><p>Any spoke lengths shown will be <b>wrong</b>.</p>")}g(){e.get("messageText").innerHTML="";e.get("message").style.display="none"}}function E(a,b){return a?'<span class="errorText">'+b+" </span>":b}
function xa(){var a=F;a.j=[];a.B=[];a.J=[];a.e=[];a.h=0;e.get("infoCalcLog").innerHTML="<h1>Calculation log</h1><p>This will display additional information about the spoke length calculation. You do not need to check the log, but if you are interested in seeing how the calculation was performed then take a look here after you calculate a spoke table.</p>"}function H(a){F.B.push(a)}function I(a){F.J.push(a)}
class ya{constructor(){this.j=[];this.B=[];this.J=[];this.e=[];this.h=0}g(){let a,b;1<arguments.length?(a=arguments[0],b=arguments[1]):(a=!1,b=arguments[0]);this.j.push({tag:a,info:b})}error(a){this.e.push(a);this.h++}}function fa(a){a=a.target.id;aa(v);v.g[a].D&&w.set("reDraw",!0);w.set("dataChanged",!0);if("printPage"==x.h||"showCalcLog"==x.h)x.close(),xa()}
function ca(){var a;za();var b=Number.parseInt(e.get("wheelType").value,10);u=Aa[b];u.u=0==e.get("fr").value?!0:!1;u.display();b=e.get("infoWheelType").children;for(a of b)a.style.display=a.id==`type${u.index}`?"block":"none"}function da(){za();u.u=0==e.get("fr").value?!0:!1;u.display();if(u.V){var a=e.get("crossL").value;e.get("crossL").value=e.get("crossR").value;e.get("crossR").value=a}}
function sa(){w.status("dataChanged")?na("Print the spoke table"):(w.status("calcDone")?(e.get("printOK").style.display="block",e.get("printNotOK").style.display="none",ea()):(e.get("printOK").style.display="none",e.get("printNotOK").style.display="block"),x.show("printPage"))}function ea(){""==e.get("hubName").value.trim()||""==e.get("rimName").value.trim()?e.get("printNames").style.display="block":e.get("printNames").style.display="none"}
function za(a=!1){e.get("sL").innerHTML="";e.get("sR").innerHTML="";e.get("cL").innerHTML="";e.get("cR").innerHTML="";e.get("eL").innerHTML="";e.get("eR").innerHTML="";e.get("tL").innerHTML="";e.get("tR").innerHTML="";e.get("calculationNotes").innerHTML="";e.get("wheelComponentsPrint").innerHTML="";e.get("wheelComponentsSave").innerHTML="";e.get("calculationDate").innerHTML="";e.get("calculationLink").innerHTML="";e.get("calculationData").innerHTML="";e.get("dataUsed").innerHTML="";e.get("calculationWrap").style.display=
"none";e.get("printText").style.display="none";e.get("lineLengthLeft").innerHTML="";e.get("lineLengthRight").innerHTML="";aa(v);h.g();xa();w.set("dataChanged",!1);w.set("reDraw",!0);w.set("calcDone",!1);a||(a=x,a=a.h&&"keepOpen"in a.g[a.h]?!1:!0);a&&x.close()}function na(a){h.show(`<h1>${a}</h1><p>The data has changed. Re calculate then select this menu option again.</p>`)}
function J(){za(!0);var a=v;var b=u.Y;var c=u.u;for(l of b)c&&"frameOffset"==l?a.g[l].value="failSafe":(b=e.get(l).value.trim(),0==b.length&&2==a.g[l].l?F.error(a.g[l].name+" needs an entry."):a.g[l].numeric?isNaN(b)?F.error(a.g[l].name+" has invalid characters."):(b=Number(b),0>b&&2!=a.g[l].l?F.error(a.g[l].name+" should be greater than zero."):0==b&&0==a.g[l].l?F.error(a.g[l].name+" should be greater than zero."):a.g[l].value=b):a.g[l].value=b);for(f in a.g)a.g[f].U&&(b=e.get(f).value.trim(),a.g[f].numeric&&
(b=Number(b)),a.g[f].value=b);if(!F.h){var f=u.$?!1:!0;a=v.value("flangeL");c=v.value("flangeR");if(0<v.value("asym")||0<v.value("rimHoleWidth")||!u.u&&0<v.value("frameOffset")||f&&0==v.value("crossL")||f&&0==v.value("crossR")){F.g("h1","Modify the hub flange offsets");var k=!0;F.g("Original flange offsets: Left = "+a+" Right = "+c+"</b>")}else k=!1;if(!u.u&&0<v.value("frameOffset")){F.g("h2","Offset frame");F.g("Frame offset "+v.value("frameOffset"));var l=K(a);b=K(c);var g=v.value("frameOffset");
a-=g;c+=g;F.g("Adjust the left flange offset to "+K(a)+" ("+l+" - "+g+")");F.g("Adjust the right flange offset to "+K(c)+" ("+b+" + "+g+")")}g=v.value("rimHoleWidth")/2;0<g&&(F.g("h2","Adjust for rim hole width"),F.g("Divide the width between the spoke holes by 2 to get "+K(g)),!u.u&&17.5<=v.value("frameOffset")?(F.g("p","The rim <b>must</b> be a fatbike rim with a double row of spoke holes."),F.g("p","The spokes are connected to the <b>right hand</b> set of holes."),l=K(a),b=K(c),a+=g,c-=g,F.g("Adjust the left flange offset to "+
K(a)+"  ("+l+" + "+K(g)+")"),F.g("Adjust the right flange offset to "+K(c)+" ("+b+" - "+K(g)+")"),H("The rim <b>must</b> me a fatbike rim with a double row of spoke holes, with the spokes connected to the <b>right hand</b> set of holes.")):(a-=g,c-=g,F.g("Adjust the left flange offset to "+K(a)+" ("+v.value("flangeL")+" - "+K(g)+")"),F.g("Adjust the right flange offset to "+K(c)+" ("+v.value("flangeR")+" - "+K(g)+")")));g=v.value("asym");if(0<g){F.g("h2","Asymmetric rim");F.g(`Rim offset ${g}`);l=
K(a);b=K(c);var p="";a==c&&(p=u.u?"right":"left",I("The left and right flange offsets are equal and an asym rim is not advisable."));"left"==p||a>c?(H("Position the asym rim with the spoke holes towards the left side."),a-=g,c+=g,F.g(`Adjust the left flange offset to ${K(a)} (${l} - ${g})`),F.g(`Adjust the right flange offset to ${K(c)} (${b} + ${g})`)):"right"==p||a<c?(H("Position the asym rim with the spoke holes towards the right side."),a+=g,c-=g,F.g(`Adjust the left flange offset to ${K(a)} (${l} + ${g})`),
F.g(`Adjust the right flange offset to ${K(c)} (${b} - ${g})`)):h.error("getStandardOffsets() encountered an impossible condition.")}!f||0!=v.value("crossL")&&0!=v.value("crossR")||(F.g("h2","Adjust for radial lacing"),0==v.value("crossL")&&(a-=2,F.g("Subtract 2mm from the left offset."),H("Lace the left side radial, heads out (elbows in).")),0==v.value("crossR")&&(c-=2,F.g("Subtract 2mm from the right offset."),H("Lace the right side radial, heads out (elbows in).")));k&&(F.g("h2","Flange offsets used in the calculation"),
f=E(0>=a,K(a)),l=E(0>=c,K(c)),F.g("Left = "+f+" Right = "+l+"</b>"),0>=a||0>=c)&&(F.error("Calculated  flange offset error. See the log for more details."),F.g("stop","Flange offset errors"));[a,c]=[a,c];u.R();if(!F.h){[t,z,f]=u.T();var m=Ba(t,a);var q=Ba(z,c);"single"==f?(F.g("h1","Calculate the spoke lengths"),F.g("p","Use wheel geometry to obtain theoretical spoke lengths:"),F.g(`Left: ${m[0][1].toFixed(4)}`),F.g(`Right: ${q[0][1].toFixed(4)}`),F.g("p","These lengths need adjusting to account for spoke stretch."),
f=(u.V?u.u?.5:2:1)*c/a*m[0][1]/q[0][1],1>f?(c=1,a=f,f="left"):(a=1,c=1/f,f="right"),(.3>a||.3>c)&&I("The "+f+" side spoke tension will be very low."),F.g("h2","Spoke lengths required"),l=Ca(m[0][1],a,v.value("spokeDiaL")),b=Ca(q[0][1],c,v.value("spokeDiaR")),F.g("Left : "+l[0].toFixed(4)+" (will stretch "+l[1].toFixed(4)+" to make calculated length)."),F.g("Right : "+b[0].toFixed(4)+" (will stretch "+b[1].toFixed(4)+" to make calculated length)."),l[0]=l[0].toFixed(1),b[0]=b[0].toFixed(1),F.g("h2",
"Round to 1 decimal"),F.g("Left : "+l[0]),F.g("Right : "+b[0]),e.get("sL").innerHTML=l[0],e.get("sR").innerHTML=b[0],e.get("diaPrintL").innerHTML=v.value("spokeDiaL"),e.get("diaPrintR").innerHTML=v.value("spokeDiaR"),e.get("crossPrintL").innerHTML=v.value("crossL"),e.get("crossPrintR").innerHTML=v.value("crossR"),u.fa?e.get("spokeHeadClearance").style.display="none":(m[0][2]=m[0][2].toFixed(1),q[0][2]=q[0][2].toFixed(1),e.get("spokeHeadClearance").style.display="table-row-group",0>m[0][2]&&(I("The left spoke head will overlap."),
m[0][2]=E(!0,m[0][2])),0>q[0][2]&&(I("The right spoke head will overlap."),q[0][2]=E(!0,q[0][2])),e.get("cL").innerHTML=m[0][2],e.get("cR").innerHTML=q[0][2]),e.get("eL").innerHTML=m[0][3].toFixed(1),e.get("eR").innerHTML=q[0][3].toFixed(1),a=1==a?100:(100*a).toFixed(0),c=1==c?100:(100*c).toFixed(0),a==c||u.V||(v.value("spokeDiaL")>v.value("spokeDiaR")&&"left"==f&&I("Using a thicker spoke on the lower tensioned left side makes a poor wheel."),v.value("spokeDiaR")>v.value("spokeDiaL")&&"right"==f&&
I("Using a thicker spoke on the lower tensioned right side makes a poor wheel.")),e.get("tL").innerHTML=a+"%",e.get("tR").innerHTML=c+"%",e.get("singleLength").style.display="block",e.get("multiWrap").style.display="none"):(f=c/a,1>f?(a=1,c=f,f="left"):(c=1,a=1/f,f="right"),(.3>c||.3>a)&&I("The "+f+" side spoke tension will be very low."),4==u.index&&(0==v.value("eccOffset")?(F.g("p","That was boring."),F.g("p","Enjoy your non eccentric wheel!")):(F.g("p","Shift the hub off centre."),F.g("p","Calculate loads of spoke lengths."),
F.g("p","Job done!"))),c='<table>\n<tbody>\n<tr><th colspan="5" class="multiHeading">Left\n'+(L(m,"L",c,v.value("spokeDiaL"))+L(m,"T",c,v.value("spokeDiaL"))+L(m,"R",c,v.value("spokeDiaL"))),c+="</table>",a='<table>\n<tbody>\n<tr><th colspan="5" class="multiHeading">Right\n'+(L(q,"L",a,v.value("spokeDiaR"))+L(q,"T",a,v.value("spokeDiaR"))+L(q,"R",a,v.value("spokeDiaR"))),a+="</table>",e.get("multipleLength").innerHTML=c+a,e.get("singleLength").style.display="none",e.get("multiWrap").style.display=
"block")}}if(F.h){F.g("stop","Data errors");var B=h;var z=B.show;var t=F;m="";for(var C of t.e)m+=`<p>${C}</p>`;z.call(B,`<h1>Calculation error</h1>${m}`);w.set("reDraw",!0)}else{C=oa();y("wheelTitle",u.title);y("wheelComponentNames",`${C.o}<br>${C.m}`);y("dataUsed",Da(u.Y));C=e.get("calculationNotes");a=F;c="";for(R of a.B)c+=`<p>${R}</p>`;for(R of a.J)c+=`<p><span class="warning">Warning</span> ${R}</p>`;C.innerHTML=c;v.value("hubName")&&v.value("rimName")?(Ea("Calculation URL",ha(),!0),Ea(!1,"<p>Click the link to copy it to the clipboard.</p>",
!1)):Ea("Calculation URL","<p>Hub and rim names are required.</p><p>Add the missing names and re calculate.</p>",!1);y("calculationDate",Fa());y("calculationLink",ha("hrefLink"));e.get("calculationWrap").style.display="block";y("lineLengthLeft",Ga(m));y("lineLengthRight",Ga(q));m=z;z=r;q=u.la*Math.PI/180;C=t.m.I*Math.cos(q);var R=t.m.I*Math.sin(q);-1==ia.indexOf(Ha)&&(v.g=[]);C=`<circle cx="${C}" cy="${-R}"	r="2" stroke="#c00" fill="#c00">`;y("svgRim",M(t,"rim")+M(m,"rim")+C);y("svgGuidesLeft",Ia(t));
y("svgGuidesRight",Ia(m));y("svgSpokesLeft",Ja(t));y("svgSpokesRight",Ja(m));y("svgHubLeft",M(t,"hub"));y("svgHubRight",M(m,"hub"));e.get("svgScale").setAttribute("transform",`scale(${600/(2*t.m.I+8)})`);n(z,"cNR")?e.get("svgWheel").setAttribute("transform","rotate(0)"):(t=180*-q/Math.PI+90,e.get("svgWheel").setAttribute("transform",`rotate(${-t})`));for(B in z.g)"svgShow"!=B&&z.g[B].status&&(Ka(z,B,!1),N(z,B));w.set("dataChanged",!1);w.set("reDraw",!1);w.set("calcDone",!0);w.set("startup",!1)}B=
F;z=!1;t="";let G;if(0<B.j.length){for(G of B.j){if("stop"==G.tag){z&&(t+="</ul>\n");t+=`<h1>Calculation stopped</h1><p>${G.info}</p>`;break}G.tag?(z&&(t+="</ul>\n",z=!1),t+=`<${G.tag}>${G.info}</${G.tag}>\n`):(z||(t+="<ul>\n",z=!0),t+=`  <li>${G.info}\n`)}z&&(t+="</ul>\n")}else t="<p>Nothing to report.</p>";y("infoCalcLog",t)}
function Ba(a,b){var c;var f=1;var k=[];for(c of a.map){var l=O(a.o,c[0]);var g=O(a.m,c[1]);var p=g.x-l.x;var m=g.y-l.y;var q=Math.hypot(p,m);m=O(a.o,c[0]-1);p=m.x-l.x;m=m.y-l.y;p=Math.hypot(p,m);m=(a.o.I**2+q**2-a.m.I**2)/(2*a.o.I*q);-1>m&&(m=-1);1<m&&(m=1);m=Math.acos(m);var B=Math.acos(p/a.o.I/2);m-=B;p=Math.sin(m)*p-3;g=(g.A**2+q**2-l.A**2)/(2*g.A*q);-1>g&&(g=-1);1<g&&(g=1);g=Math.acos(g);l=Math.hypot(q,b)+a.lengthAdjust;k.push([f++,l,p,180*g/Math.PI,c[2],q.toFixed(4)])}return k}
function Ga(a){let b;var c=new Set;for(b of a)c.add(b[5]);if(1<c.size){c="<table>\n";for(b of a)c+=`<tr><td>${b[0]}<td>${b[5]}\n`;c+="</table>"}else c=`<div>${a[0][5]}</div>`;return c}
function L(a,b,c,f){var k;var l="";for(k of a)if(k[4]==b){if("L"==k[4]){var g="Leading";var p="multiLeading"}else"T"==k[4]?(g="Trailing",p="multiTrailing"):"R"==k[4]?(g="Radial",p="multiRadial"):console.log("multiLengths() found unknown spoke direction");k[1]=Ca(k[1],c,f)[0];l+=`<tr><td>${k[0]} <td>${k[1].toFixed(1)} <td style="padding:0 2rem"> <td>${k[3].toFixed(0)}<td class="${p}">${g}\n`}return l}
function Ea(a,b,c){b=b.replace(/&/g,"&amp;");c&&(b=`<p><span>${b}</span></p>`);c=document.createElement("div");c.innerHTML=`${a?`<h1>${a}</h1>`:""}${b}`;e.get("calculationData").append(c)}function Fa(){var a=new Date;return`${"January February March April May June July August September October November December".split(" ")[a.getMonth()]} ${a.getDate()}, ${a.getFullYear()}`}
function Da(a,b=!0){var c,f;var k={pcdL:{K:"pcdR",P:!1},flangeL:{K:"flangeR",P:!1},spOffsetL:{K:"spOffsetR",P:!1},crossL:{K:"crossR",P:!0},spokeDiaL:{K:"spokeDiaR",P:!0}};var l="<table>\n";for(c of a){a="";var g=[];var p=!1;if("asym"!=c||0!=v.value("asym"))if("rimHoleWidth"!=c||0!=v.value("rimHoleWidth"))if("frameOffset"!=c||!u.u&&0!=v.value("frameOffset")){var m=!1;for(f in k)if(c==k[f].K){m=!0;break}if(!m){m=v.get(c).title;!b||"spokeDiaL"!=c&&"crossL"!=c||(a=' class="printHide"');if(c in k)k[c].P&&
(p=v.value(c)==v.value(k[c].K)?!0:!1),g=p?[v.value(c)]:[v.value(c),v.value(k[c].K)];else switch(c){case "tripletSpokes":p=D(v.value(c));g[0]=p.left;g[1]=p.right;break;case "pairValue":if(u.ba&&u.Z)g=[v.value(c)];else continue;break;case "pairLacing":if(u.ba&&u.Z)g=[0==v.value(c)?"Open":"Crossed"];else continue;break;default:g=[v.value(c)]}l+=`<tr${a}><th>${m}${void 0==g[1]?`<td colspan="2">${g[0]}`:`<td>${g[0]}<td>${g[1]}`}\n`}}}return l+"</table>"}function y(a,b){e.get(a).innerHTML=b}
function Ca(a,b,c){b=a/(981*b/(Math.PI/4*c*c)/21E4+1);return[b,a-b]}function K(a,b=4){a=a.toFixed(b);a=a.replace(/0+$/,"");return a=a.replace(/\.$/,"")}function D(a){var b=a/3;var c=2*b;a=u.u?{left:c,right:b,m:a,aa:"left"}:{left:b,right:c,m:a,aa:"right"};y("spokeRatio",a.left+" : "+a.right);return a}
function La(){if(!v.h.data_paired_hub.C||""==v.value("pairValue")&&9==v.value("pairLacing"))return!1;if(0<v.value("spokes")%4)return F.error(`Paired hub holes is not possible with ${v.value("spokes")} spokes.`),!1;if(""==v.value("pairValue"))return F.error("Paired spoke holes : Pair value missing."),!1;if(9==v.value("pairLacing"))return F.error("Paired spoke holes : Lacing type required."),!1;var a=v.value("pairValue").match(/(\d*)\s*(\D*)/);a[1]=parseFloat(a[1]);a[2]=a[2].toLowerCase();return isNaN(a[1])||
""!=a[2]&&"deg"!=a[2]?(F.error("Paired spoke holes : Invalid pair dimension."),!1):""!=a[2]?a[1]:360*Math.asin(a[1]/2/(v.value("pcdL")/2))/Math.PI}
function P(a){var b=v.value("erd");(v.value("pcdL")>b||v.value("pcdR")>b)&&F.error("One of the hub diameters is greater that the rim erd.");0<v.value("asym")&&0<v.value("rimHoleWidth")&&I('Asym rims do not normally have a "width between holes".');a.u||17.5!=v.value("frameOffset")||0!=v.value("rimHoleWidth")||0!=v.value("asym")||I("A better tension balance can be achieved by using a Fatbike rim with a double row of spoke holes, or an Asymmetric rim.");!a.u&&28==v.value("frameOffset")&&0==v.value("rimHoleWidth")&&
0<=v.value("asym")&&I("A better tension balance can be achieved by using a Fatbike rim with a double row of spoke holes.");a.J&&(b=La(),a.j=!1===b?"notSet":b);a.B||(Number.isInteger(v.value("spokes"))?0<v.value("spokes")%2&&F.error("Spoke count must be an even number."):F.error("Spoke count must be a whole number."));a.h&&(a.h?v.value("flangeL")>v.value("flangeR")&&I("Front wheel. The left flange offset is greater than the right."):v.value("flangeR")>v.value("flangeL")&&I("Rear wheel. The right flange offset is greater than the left."));
a.$||(2>=v.value("holeDia")||4<=v.value("holeDia"))&&I("The spoke hole diameter in the hub could be invalid.");a=a.B;Number.isInteger(v.value("crossL"))||F.error("Left cross must be a whole number.");Number.isInteger(v.value("crossR"))||F.error("Right cross must be a whole number.");a||(0<v.value("crossL")||0<v.value("crossR"))&&0<v.value("spokes")%4&&F.error(`Cross lacing is not possible with ${v.value("spokes")} spokes.`)}
class Q{constructor(a,b,c,f,k,l,g,p){this.da=a;this.ka=b;this.h=!0;this.$=c;this.B=f;this.J=k;this.ga=l;this.ha=g;this.ja=p;this.j="notSet";this.g=0}display(){v.display(this.ga,this.h,this.J);this.B&&D(e.get("tripletSpokes").value)}get index(){return this.ka}get u(){return this.h}set u(a){this.h=a}get fa(){return this.$}get V(){return this.B}get ba(){return this.J}get Z(){return"notSet"==this.j?!1:this.j}get la(){return this.g}get Y(){return this.ha}get ia(){return this.ja}get title(){return`${this.h?
"Front":"Rear"} ${this.da} wheel`}}
class Ma extends Q{constructor(){super("",0,!1,!1,!0,["data_spoke_hole_dia","data_standard_lacing"],"pcdL pcdR flangeL flangeR holeDia pairValue pairLacing erd asym rimHoleWidth frameOffset spokes crossL crossR spokeDiaL spokeDiaR".split(" "),"pcdL pcdR pairValue pairLacing erd crossL crossR spokes".split(" "))}R(){P(this)}T(){var a=new S(v.value("pcdL"),v.value("erd"),v.value("spokes")/2,v.value("crossL"),-v.value("holeDia")/2);var b=new S(v.value("pcdR"),v.value("erd"),v.value("spokes")/2,v.value("crossR"),
-v.value("holeDia")/2);if(this.Z){const c=v.value("pairLacing");T(a,"hub",this.j,0==c?"pos":"neg");T(b,"hub",this.j,0==c?"pos":"neg")}this.g=.5*-(360/v.value("spokes"));U(a,.5);return[a,b,"single"]}}let Na=new Ma;
class Oa extends Q{constructor(){super("straight pull",1,!0,!1,!1,["data_hub_sp","data_standard_lacing"],"pcdL pcdR flangeL flangeR spOffsetL spOffsetR erd asym rimHoleWidth frameOffset spokes crossL crossR spokeDiaL spokeDiaR".split(" "),"pcdL pcdR erd crossL crossR spokes".split(" "))}R(){P(this);(3<v.value("crossL")||3<v.value("crossR"))&&I("Greater than 3 cross on a straight pull wheel is very rare, you need to check if this value is correct.");0==v.value("crossL")&&0!=v.value("spOffsetL")&&I("Left spoke offset: An offset has been specified for a straight pull radial lacing pattern.");
0==v.value("crossR")&&0!=v.value("spOffsetR")&&I("Right spoke offset: An offset has been specified for a straight pull radial lacing pattern.");(0<v.value("crossL")&&0==v.value("spOffsetL")||0<v.value("crossR")&&0==v.value("spOffsetR"))&&I("A spoke offset of zero has been specified for a cross laced straight pull hub. Could be correct, but it's worth checking.")}T(){var a=new S(v.value("pcdL"),v.value("erd"),v.value("spokes")/2,v.value("crossL"),v.value("spOffsetL"));var b=new S(v.value("pcdR"),v.value("erd"),
v.value("spokes")/2,v.value("crossR"),v.value("spOffsetR"));0<v.value("crossL")&&T(a,"hub",0,"pos");0<v.value("crossR")&&T(b,"hub",0,"pos");this.g=.5*-(360/v.value("spokes"));U(a,.5);return[a,b,"single"]}}let Pa=new Oa;
class Qa extends Q{constructor(){super("triplet (2:1)",2,!1,!0,!1,["data_spoke_hole_dia","data_triplet_spokes","data_triplet_lacing"],"pcdL pcdR flangeL flangeR holeDia erd asym rimHoleWidth frameOffset tripletSpokes lacingOption crossL crossR spokeDiaL spokeDiaR".split(" "),"pcdL pcdR erd crossL crossR tripletSpokes lacingOption".split(" "))}R(){P(this);var a=D(v.value("tripletSpokes"));a.left%2&&0<v.value("crossL")&&F.error(`Cross lacing the left side is not possible with an odd number of spokes (${a.left})`);
a.right%2&&0<v.value("crossR")&&F.error(`Cross lacing the right side is not possible with an odd number of spokes (${a.right})`);v.value("spokeDiaL")!=v.value("spokeDiaR")&&I("With triplet lacing, you are better using the same diameter spoke either side.")}T(){var a=D(v.value("tripletSpokes"));if(1==v.value("lacingOption")){var b="neg";var c=1.5;var f=-.5}else b="pos",c=.5,f=-.167;var k=new S(v.value("pcdL"),v.value("erd"),a.left,v.value("crossL"),-v.value("holeDia")/2);var l=new S(v.value("pcdR"),
v.value("erd"),a.right,v.value("crossR"),-v.value("holeDia")/2);"left"==a.aa?(T(k,"rim",360/a.m,b),U(k,c),this.g=360/a.right*f):(T(l,"rim",360/a.m,b),U(l,c),this.g=360/a.left*f);return[k,l,"single"]}}let Ra=new Qa;
class Sa extends Q{constructor(){super("G3 (2:1)",3,!1,!0,!1,["data_spoke_hole_dia","data_g3_width","data_triplet_spokes"],"pcdL pcdR flangeL flangeR holeDia erd asym rimHoleWidth g3width frameOffset tripletSpokes crossL crossR spokeDiaL spokeDiaR".split(" "),"pcdL pcdR erd g3width crossL crossR tripletSpokes".split(" "))}R(){P(this);var a=D(v.value("tripletSpokes"));a.left%2&&0<v.value("crossL")&&F.error(`Cross lacing the left side is not possible with an odd number of spokes (${a.left})`);a.right%
2&&0<v.value("crossR")&&F.error(`Cross lacing the right side is not possible with an odd number of spokes (${a.right})`);v.value("spokeDiaL")!=v.value("spokeDiaR")&&I("With triplet lacing, you are better using the same diameter spoke either side.");10>v.value("g3width")&&F.error("G3 Dimension is too small")}T(){var a=D(v.value("tripletSpokes"));var b=360*Math.asin(v.value("g3width")/2/(v.value("erd")/2))/Math.PI;var c=new S(v.value("pcdL"),v.value("erd"),a.left,v.value("crossL"),-v.value("holeDia")/
2);var f=new S(v.value("pcdR"),v.value("erd"),a.right,v.value("crossR"),-v.value("holeDia")/2);"left"==a.aa?(T(c,"rim",b,"neg"),U(c,.5),this.g=.5*-(360/a.right)):(T(f,"rim",b,"neg"),U(f,.5),this.g=.5*-(360/a.left));return[c,f,"single"]}}let Ta=new Sa;
class Ua extends Q{constructor(){super("eccentric",4,!1,!1,!1,["data_spoke_hole_dia","data_eccentric_offset","data_standard_lacing"],"pcdL pcdR flangeL flangeR holeDia eccOffset erd asym rimHoleWidth frameOffset spokes crossL crossR spokeDiaL spokeDiaR".split(" "),"pcdL pcdR eccOffset erd crossL crossR spokes".split(" "))}R(){P(this)}T(){var a=new S(v.value("pcdL"),v.value("erd"),v.value("spokes")/2,v.value("crossL"),-v.value("holeDia")/2);var b=new S(v.value("pcdR"),v.value("erd"),v.value("spokes")/
2,v.value("crossR"),-v.value("holeDia")/2);this.g=.5*-(360/v.value("spokes"));U(a,.5);var c=v.value("eccOffset"),f=this.g;Va(a.o,c,f);Va(a.g,c,f);c=v.value("eccOffset");f=this.g;Va(b.o,c,f);Va(b.g,c,f);return[a,b,"multiple"]}}let Wa=new Ua;function O(a,b){b=V(a,b);return{x:a.g[b].A*Math.cos(a.g[b].dir),y:a.g[b].A*Math.sin(a.g[b].dir),A:a.g[b].A,dir:a.g[b].dir}}function Xa(a,b){for(var c=0;c<a.j;c++)a.g[c].dir+=b}function V(a,b){a=a.g.length;if(b>=a)for(;b>=a;)b-=a;else for(;0>b;)b+=a;return b}
function Ya(a,b,c,f){b=b*Math.PI/180;b=(360/a.j*Math.PI/180-b)/2;"neg"==f&&(b=-b);f=c;for(c=0;c<a.g.length;c+=2)a.g[V(a,f)].dir+=b,a.g[V(a,f+1)].dir-=b,f+=2}function Va(a,b,c){var f;c=c*Math.PI/180;var k=b*Math.cos(c);var l=b*Math.sin(c);for(f=0;f<a.g.length;f++){const {x:m,y:q}=O(a,f);var g=Math.hypot(k+m,l+q);var p=Math.atan((l+q)/(k+m));0>k+m&&(p=Math.PI+p);a.g[f].dir=p;a.g[f].A=g}a.h=[b,c]}
function Za(a,b){var c,f="";if(b)for(c of a.g){b=c.A*Math.cos(c.dir);var k=c.A*Math.sin(c.dir);f+=`<circle cx="${b}" cy="${-k}" r="3.5" stroke-width="1" stroke="#999" fill="#ccc" />\n`}return f+=`<circle cx="${a.h[0]*Math.cos(a.h[1])}" cy="${-(a.h[0]*Math.sin(a.h[1]))}" r="${a.I}"/>\n`}class $a{constructor(a,b){this.I=a/2;this.j=b;this.g=[];var c=360/b*Math.PI/180;for(a=0;a<b;a++)this.g.push({A:this.I,dir:a*c});this.h=[0,0]}}function T(a,b,c,f){"hub"==b?Ya(a.o,c,a.X,f):Ya(a.m,c,0,f);ab(a)}
function U(a,b){n(r,"cNR")||(b=360/a.o.j*b*Math.PI/180,Xa(a.o,b),Xa(a.m,b),Xa(a.g,b))}function ab(a){var b;for(b=0;b<a.map.length;b++){var c=a.map[b][0];var f=a.map[b][1];var k=a.o.g[c].dir;var l=-a.o.g[c].A;c=a.m.g[f].A;k=a.m.g[f].dir-k;c=Math.atan2(l*Math.sin(0)+c*Math.sin(k),l*Math.cos(0)+c*Math.cos(k));a.map[b][2]=0<c?"T":0>c?"L":"R"}}
function Ia(a){var b,c="";for(b=0;b<a.g.j;b++){var f=O(a.g,b);var k=f.x;var l=f.y;f=O(a.m,b);var g=f.x;f=f.y;c+=`<line x1="${k}" y1="${-l}" x2="${g}" y2="${-f}"/>`}return c}function M(a,b){return"hub"==b?Za(a.o,!1):Za(a.m,!0)}function Ja(a){var b;var c="";var f=0;for(b of a.map){var k=O(a.o,b[0]);var l=O(a.m,b[1]);c+=`<line data-spoke="${f++}" data-group="${b[2]}" x1="${k.x}" y1="${-k.y}" x2="${l.x}" y2="${-l.y}" />\n`}return c}
class S{constructor(a,b,c,f,k){this.o=new $a(a,c);this.m=new $a(b,c);this.g=new $a(a,c);this.X=f;this.lengthAdjust=k;this.map=[];for(a=f;;){a=V(this.o,a);if(0==f){if(this.map.push([a,a])==c)break}else{b=V(this.m,a-f);if(this.map.push([a,b])==c)break;a++;a=V(this.o,a);b=V(this.m,a+f);if(this.map.push([a,b])==c)break}a++}ab(this)}}function n(a,b){return a.g[b].status}
function A(a){var b=r;"hide"==a?(e.get("svgContainer").style.display="none",e.get("svgShow").style.display="none"):(b.g.svgShow.status?e.get("svgContainer").style.display="block":e.get("svgContainer").style.display="none",e.get("svgShow").style.display="inline")}
function N(a,b){if(n(a,b)){var c=!0;Ka(a,b,!1)}else c=!1,Ka(a,b,!0);switch(b){case "cLeft":c?(a.show("svgSpokesRight"),e.get("svgHubLeft").setAttribute("class","svgHubWheel"),e.get("svgHubRight").style.visibility="visible"):(n(a,"cRight")&&N(a,"cRight"),a.s("svgSpokesRight"),e.get("svgHubLeft").setAttribute("class","svgHubDetail"),e.get("svgHubRight").style.visibility="hidden");break;case "cRight":c?(a.show("svgSpokesLeft"),e.get("svgHubRight").setAttribute("class","svgHubWheel"),e.get("svgHubLeft").style.visibility=
"visible"):(n(a,"cLeft")&&N(a,"cLeft"),a.s("svgSpokesLeft"),e.get("svgHubRight").setAttribute("class","svgHubDetail"),e.get("svgHubLeft").style.visibility="hidden");break;case "cLeading":c?(W("show","T"),W("show","R")):(n(a,"cTrailing")&&N(a,"cTrailing"),W("hide","T"),W("hide","R"));break;case "cTrailing":c?(W("show","L"),W("show","R")):(n(a,"cLeading")&&N(a,"cLeading"),W("hide","L"),W("hide","R"));break;case "cLeftColor":c?e.get("svgSpokesLeft").classList.remove("svgSpokesLeftColor"):e.get("svgSpokesLeft").classList.add("svgSpokesLeftColor");
break;case "cGuides":c&&(a.s("svgGuidesLeft"),a.s("svgGuidesRight"));break;case "cPrint":w.status("reDraw")?h.show("<h1>The drawing needs refreshing</h1><p>Calculate the spoke lengths to refresh the drawing.</p>"):(x.close(),e.get("lineLengthLeft").style.display="none",e.get("lineLengthRight").style.display="none",n(a,"cLeft")?e.get("lineLengthLeft").style.display="block":(n(a,"cRight")||(e.get("lineLengthLeft").style.display="block"),e.get("lineLengthRight").style.display="block"),e.get("calculationWrap").style.display=
"none",e.get("wheelComponentsPrint").style.display="none",e.get("leftWrap").style.display="none",e.get("drawingParametersWrap").style.display="block",c=`<h1>${u.title}</h1>\n<p>`,n(a,"cLeft")&&(c+="Left side."),n(a,"cRight")&&(c+="Right side."),n(a,"cLeading")&&(c+=" Leading spokes."),n(a,"cTrailing")&&(c+=" Trailing spokes."),c+=Da(u.ia,!1),y("drawingParameters",c),window.print(),e.get("lineLengthLeft").style.display="none",e.get("lineLengthRight").style.display="none",e.get("calculationWrap").style.display=
"block",e.get("leftWrap").style.display="block",e.get("drawingParametersWrap").style.display="none");Ka(a,"cPrint",!1);break;case "svgShow":c?(e.get("svgMenuWrap").classList.replace("svgMenuWrapOn","svgMenuWrapOff"),e.get("svgMenu").style.display="none",e.get("svgContainer").style.display="none",x.close()):(e.get("svgMenuWrap").classList.replace("svgMenuWrapOff","svgMenuWrapOn"),e.get("svgMenu").style.display="inline",e.get("svgContainer").style.display="block");break;case "cSZ":b=document.querySelectorAll('line[data-spoke="0"]'),
c?X(b,!1):X(b,!0)}n(a,"cGuides")&&(n(a,"cLeft")?a.show("svgGuidesLeft"):a.s("svgGuidesLeft"),n(a,"cRight")?a.show("svgGuidesRight"):a.s("svgGuidesRight"));4==u.index&&(c=document.querySelectorAll('line[data-spoke="0"]'),X(c,!1),n(a,"cLeft")?(c=document.querySelectorAll('#svgSpokesLeft line[data-spoke="0"]'),X(c,!0)):n(a,"cRight")&&(c=document.querySelectorAll('#svgSpokesRight line[data-spoke="0"]'),X(c,!0)))}
function Ka(a,b,c){b in a.g&&(c?(e.get(b).classList.add("menuOn"),a.g[b].status=1):(e.get(b).classList.remove("menuOn"),a.g[b].status=0))}function W(a,b){var c;b=document.querySelectorAll(`line[data-group="${b}"]`);for(c of b)"hide"==a?c.classList.add("svgSpokeHide"):c.classList.remove("svgSpokeHide")}function X(a,b){for(var c of a)b?c.classList.add("spokeZero"):c.classList.remove("spokeZero")}
class bb{constructor(){this.g={svgShow:{status:!1,F:"dr"},cLeft:{status:!1,F:"c1"},cRight:{status:!1,F:"c2"},cLeading:{status:!1,F:"c3"},cTrailing:{status:!1,F:"c4"},cGuides:{status:!1,F:"c5"},cLeftColor:{status:!1,F:"c6"},cPrint:{status:!1,F:"c7"},cNR:{status:0,F:"c8"},cSZ:{status:0,F:"c9"}};for(let a in this.g)e.get(a).addEventListener("click",()=>{N(this,a)})}show(a){e.get(a).style.display="inline"}s(a){e.get(a).style.display="none"}}
function cb(a){a.g=0;a.h=0;e.get("offsetW").value="";e.get("offsetL").value="";e.get("offsetR").value="";e.get("offsetL").style.backgroundColor="var(--info-color)";e.get("offsetR").style.backgroundColor="var(--info-color)";e.get("offsetButton").style.visibility="hidden";var b=db(e.get("offsetH"));if(0!=b){var c=db(e.get("offsetX"));var f=db(e.get("offsetY"));0<c&&(a.g=b/2-c,0>=a.g?e.get("offsetL").value="":e.get("offsetL").value=K(a.g,1));0<f&&(a.h=b/2-f,0>=a.h?e.get("offsetR").value="":e.get("offsetR").value=
K(a.h,1));0<a.g&&0<a.h?(e.get("offsetW").value=K(a.g+a.h,1),e.get("offsetL").style.backgroundColor="var(--offset-color)",e.get("offsetR").style.backgroundColor="var(--offset-color)",e.get("offsetButton").style.visibility="visible"):e.get("offsetW").innerHTML=""}}function db(a){a=a.value;isNaN(a)?a=0:(a=Number(a),0>a&&(a=0));return a}
class eb{constructor(){e.get("offsetH").addEventListener("input",()=>cb(this));e.get("offsetX").addEventListener("input",()=>cb(this));e.get("offsetY").addEventListener("input",()=>cb(this));this.h=this.g=0;e.get("offsetButton").addEventListener("click",()=>{var a=this.g;e.get("flangeL").value=a;a=this.h;e.get("flangeR").value=a;w.set("dataChanged",!0)})}}
class fb{constructor(){this.g={startup:!0,dataChanged:!1,reDraw:!1,calcDone:!1};e.get("reCalcPrompt").addEventListener("click",J);e.get("reCalcPromptMulti").addEventListener("click",J);e.get("svgReCalc").addEventListener("click",J)}set(a,b){switch(a){case "dataChanged":if(this.g.startup){b=!1;break}b?(e.get("reCalcPrompt").style.visibility="visible",e.get("reCalcPromptMulti").style.visibility="visible"):(e.get("reCalcPrompt").style.visibility="hidden",e.get("reCalcPromptMulti").style.visibility="hidden");
break;case "reDraw":this.g.startup?b=!1:b?e.get("svgReCalc").style.visibility="visible":e.get("svgReCalc").style.visibility="hidden"}this.g[a]=b}status(a){return this.g[a]}}function pa(a){a=a.replace(/</g,"&lt;");return a=a.replace(/>/g,"&gt;")}class gb{constructor(){let a,b;this.g={};b=document.querySelectorAll("[id]");for(a of b)this.set(a.id)}get(a){if(this.g.hasOwnProperty(a))return this.g[a];console.log(`domList does not contain ${a}`)}set(a){this.g[a]=document.getElementById(a)}}
var e=new gb,v=new ba,Y=new ja,x=new qa,h=new wa,F=new ya,ua=new la,Aa=[Na,Pa,Ra,Ta,Wa],u=Aa[0],w=new fb;
e.get("printButton").addEventListener("click",function(){x.close();var a=oa();y("wheelComponentsPrint",`<h1>${a.o}<br>${a.m}<br>${a.type} - ${a.ca}</h1>`);var b=e.get("printTextArea").value.trim();if(""!=b){var c=b.startsWith("<")?"":"<p>";b=c+b.replace(/\n+/g,"<p>");e.get("printText").innerHTML=b;e.get("printText").style.display="block"}else e.get("printText").style.display="none";e.get("printDate").innerHTML=`Print date : ${Fa()}`;e.get("printWrap").style.display="block";c=document.title;document.title=
a.o+"-"+a.m;A("hide");e.get("leftWrap").style.display="none";e.get("wheelComponentsPrint").style.display="block";window.print();e.get("wheelComponentsPrint").style.display="none";e.get("leftWrap").style.display="block";A("restore");document.title=c;e.get("printWrap").style.display="none"});e.get("fixedClose").addEventListener("click",h.h);e.get("message").addEventListener("click",h.g);e.get("tripletSpokes").addEventListener("change",a=>D(a.target.value));
e.get("saveDataMenuLink").addEventListener("click",()=>ma(!0));e.get("saveDataCancel").addEventListener("click",()=>ma(!1));e.get("saveDataCopy").addEventListener("click",function(a){a.preventDefault();window.getSelection().selectAllChildren(e.get("calculationWrap"));document.execCommand("copy")});e.get("calculationData").addEventListener("click",function(a){"span"==a.target.nodeName.toLowerCase()&&window.getSelection().selectAllChildren(a.target.parentNode);document.execCommand("copy")});
e.get("togglePair").addEventListener("click",()=>{var a=v;a.h.data_paired_hub.C?d(a,"data_paired_hub",!1):d(a,"data_paired_hub",!0);w.set("dataChanged",!0);w.set("reDraw",!0);x.close()});e.get("leftWrap").addEventListener("click",a=>{"DIV"==a.target.nodeName&&J()});e.get("mySettings").addEventListener("click",hb);function hb(){x.show("internalSettings")}e.get("version").innerHTML="public-1";var ib=!0,ia="",Ha="ro.co.";
window.onscroll=function(){ib&&(50<document.body.scrollTop||50<document.documentElement.scrollTop)&&(e.get("mobileNoteWrap").style.display="none",ib=!1)};var r=new bb;new eb;var jb="url";let kb,lb,mb,nb;Y.g.clear();"url"==jb&&(jb=document.location.search.substring(1));kb=new URLSearchParams(jb);for(lb of kb.entries()){mb=lb[0];nb=lb[1];var ob=mb,pb=v;mb=pb.j.has(ob)?pb.j.get(ob):ob;Y.g.set(mb,nb)}var Z,qb,rb="";
for(const [a,b]of Y.g)if(Z=v.get(a)){if(Z.v)if(Z.v.includes(b))qb=!0;else if(Z.v.includes("free"))"select"==ua.G(a)&&(ka(ua,"input",a),qb=!0);else{var sb=rb,tb;var ub=a,vb=v;vb.g.hasOwnProperty(ub)?tb=vb.g[ub].name:(h.error(`Function data.fieldDescription(). Parameter ${ub} not found in data.list.`),tb=void 0);rb=sb+`<p>Invalid value ${b} for ${a} (${tb}). Valid entries ${Z.v.join(", ")}</p>`}else qb=!0;qb&&(e.get(a).value=b,Y.h++)}rb&&va(`<h1>Parameter errors</h1>${rb}<p>Correct the errors in the form, and check that that <b>all</b> values represent the wheel you intend to build.</p>`);
ca();10<Y.j?J():x.show("showAbout");if(Y.includes("dr"))for(const [a,b]of Object.entries(r.g))Y.includes(b.F)&&N(r,a);e.get("badBrowser").style.display="none";
